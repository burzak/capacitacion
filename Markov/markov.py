#!/usr/bin/python
import random

texto = """
En su grave rincón, los jugadores
rigen las lentas piezas. El tablero
los demora hasta el alba en su severo
ámbito en que se odian dos colores.

Adentro irradian mágicos rigores
las formas: torre homérica, ligero
caballo, armada reina, rey postrero,
oblicuo alfil y peones agresores.

Cuando los jugadores se hayan ido,
cuando el tiempo los haya consumido,
ciertamente no habrá cesado el rito.

En el Oriente se encendió esta guerra
cuyo anfiteatro es hoy toda la Tierra.
Como el otro, este juego es infinito.

Tenue rey, sesgo alfil, encarnizada
reina, torre directa y peón ladino
sobre lo negro y blanco del camino
buscan y libran su batalla armada.

No saben que la mano señalada
del jugador gobierna su destino,
no saben que un rigor adamantino
sujeta su albedrío y su jornada.

También el jugador es prisionero
(la sentencia es de Omar) de otro tablero
de negras noches y de blancos días.

Dios mueve al jugador, y éste, la pieza.
¿Qué Dios detrás de Dios la trama empieza
de polvo y tiempo y sueño y agonía?

El Golem

Si (como afirma el griego en el Cratilo)
el nombre es arquetipo de la cosa
en las letras de ‘rosa’ está la rosa
y todo el Nilo en la palabra ‘Nilo’.

Y, hecho de consonantes y vocales,
habrá un terrible Nombre, que la esencia
cifre de Dios y que la Omnipotencia
guarde en letras y sílabas cabales.

Adán y las estrellas lo supieron
en el Jardín. La herrumbre del pecado
(dicen los cabalistas) lo ha borrado
y las generaciones lo perdieron.

Los artificios y el candor del hombre
no tienen fin. Sabemos que hubo un día
en que el pueblo de Dios buscaba el Nombre
en las vigilias de la judería.

No a la manera de otras que una vaga
sombra insinúan en la vaga historia,
aún está verde y viva la memoria
de Judá León, que era rabino en Praga.

Sediento de saber lo que Dios sabe,
Judá León se dio a permutaciones
de letras y a complejas variaciones
y al fin pronunció el Nombre que es la Clave,

la Puerta, el Eco, el Huésped y el Palacio,
sobre un muñeco que con torpes manos
labró, para enseñarle los arcanos
de las Letras, del Tiempo y del Espacio.

El simulacro alzó los soñolientos
párpados y vio formas y colores
que no entendió, perdidos en rumores
y ensayó temerosos movimientos.

Gradualmente se vio (como nosotros)
aprisionado en esta red sonora
de Antes, Después, Ayer, Mientras, Ahora,
Derecha, Izquierda, Yo, Tú, Aquellos, Otros.

(El cabalista que ofició de numen
a la vasta criatura apodó Golem;
estas verdades las refiere Scholem
en un docto lugar de su volumen.)

El rabí le explicaba el universo
«esto es mi pie; esto el tuyo, esto la soga.»
y logró, al cabo de años, que el perverso
barriera bien o mal la sinagoga.

Tal vez hubo un error en la grafía
o en la articulación del Sacro Nombre;
a pesar de tan alta hechicería,
no aprendió a hablar el aprendiz de hombre.

Sus ojos, menos de hombre que de perro
y harto menos de perro que de cosa,
seguían al rabí por la dudosa
penumbra de las piezas del encierro.

Algo anormal y tosco hubo en el Golem,
ya que a su paso el gato del rabino
se escondía. (Ese gato no está en Scholem
pero, a través del tiempo, lo adivino.)

Elevando a su Dios manos filiales,
las devociones de su Dios copiaba
o, estúpido y sonriente, se ahuecaba
en cóncavas zalemas orientales.

El rabí lo miraba con ternura
y con algún horror. ‘¿Cómo’ (se dijo)
‘pude engendrar este penoso hijo
y la inacción dejé, que es la cordura?’

¿Por qué di en agregar a la infinita
serie un símbolo más? ¿Por qué a la vana
madeja que en lo eterno se devana,
di otra causa, otro efecto y otra cuita?

En la hora de angustia y de luz vaga,
en su Golem los ojos detenía.
¿Quién nos dirá las cosas que sentía
Dios, al mirar a su rabino en Praga?

Aquí está la moneda de hierro. Interroguemos
las dos contrarias caras que serán la respuesta
de la terca demanda que nadie no se ha hecho:
¿Por qué precisa un hombre que una mujer lo quiera?

Miremos. En el orbe superior se entretejan
el firmamento cuádruple que sostiene el diluvio
y las inalterables estrellas planetarias.
Adán, el joven padre, y el joven Paraíso.

La tarde y la mañana. Dios en cada criatura.
En ese laberinto puro está tu reflejo.
Arrojemos de nuevo la moneda de hierro
que es también un espejo magnífico. Su reverso
es nadie y nada y sombra y ceguera. Eso eres.
De hierro las dos caras labran un solo eco.
Tus manos y tu lengua son testigos infieles.
Dios es el inasible centro de la sortija.
No exalta ni condena. Obra mejor: olvida.
Maculado de infamia ¿por qué no han de quererte?
En la sombra del otro buscamos nuestra sombra;
en el cristal del otro, nuestro cristal recíproco.

Está bien que se mida con la dura
Sombra que una columna en el estío
Arroja o con el agua de aquel río
En que Heráclito vio nuestra locura

El tiempo, ya que al tiempo y al destino
Se parecen los dos: la imponderable
Sombra diurna y el curso irrevocable
Del agua que prosigue su camino.

Está bien, pero el tiempo en los desiertos
Otra substancia halló, suave y pesada,
Que parece haber sido imaginada
Para medir el tiempo de los muertos.

Surge así el alegórico instrumento
De los grabados de los diccionarios,
La pieza que los grises anticuarios
Relegarán al mundo ceniciento

Del alfil desparejo, de la espada
Inerme, del borroso telescopio,
Del sándalo mordido por el opio
Del polvo, del azar y de la nada.

¿Quién no se ha demorado ante el severo
Y tétrico instrumento que acompaña
En la diestra del dios a la guadaña
Y cuyas líneas repitió Durero?

Por el ápice abierto el cono inverso
Deja caer la cautelosa arena,
Oro gradual que se desprende y llena
El cóncavo cristal de su universo.

Hay un agrado en observar la arcana
Arena que resbala y que declina
Y, a punto de caer, se arremolina
Con una prisa que es del todo humana.

La arena de los ciclos es la misma
E infinita es la historia de la arena;
Así, bajo tus dichas o tu pena,
La invulnerable eternidad se abisma.

No se detiene nunca la caída
Yo me desangro, no el cristal. El rito
De decantar la arena es infinito
Y con la arena se nos va la vida.

En los minutos de la arena creo
Sentir el tiempo cósmico: la historia
Que encierra en sus espejos la memoria
O que ha disuelto el mágico Leteo.

El pilar de humo y el pilar de fuego,
Cartago y Roma y su apretada guerra,
Simón Mago, los siete pies de tierra
Que el rey sajón ofrece al rey noruego,

Todo lo arrastra y pierde este incansable
Hilo sutil de arena numerosa.
No he de salvarme yo, fortuita cosa
De tiempo, que es materia deleznable.

Lunas, marfiles, instrumentos, rosas,
lámparas y la línea de Durero,
las nueve cifras y el cambiante cero,
debo fingir que existen esas cosas.

Debo fingir que en el pasado fueron
Persépolis y Roma y que una arena
sutil midió la suerte de la almena
que los siglos de hierro deshicieron.

Debo fingir las armas y la pira
de la epopeya y los pesados mares
que roen de la tierra los pilares.

Debo fingir que hay otros. Es mentira.
Sólo tú eres. Tú, mi desventura
y mi ventura, inagotable y pura.
""".replace(",", "").lower().replace("á", "a").replace("ó", "o").replace("é", "e").replace("ú", "u").replace("í", "i")

palabras = texto.split()
dicc = {'inicio': {}}
for palabra in palabras:
    dicc[palabra.replace(".", "")] = {}

palabra_anterior = 'inicio'
for n, palabra in enumerate(palabras):
    # detecto el punto, le asigno punto una aparicion y empiezo de nuevo
    if '.' in palabra:
        palabra = palabra.replace(".", "")
        if palabra in dicc[palabra_anterior]:
            dicc[palabra_anterior][palabra] += 1
        else:
            dicc[palabra_anterior][palabra] = 1

        # le asigno mas probabilidad al punto
        if "." in dicc[palabra]:
            dicc[palabra]["."] += 1
        else:
            dicc[palabra]["."] = 1

        palabra_anterior = 'inicio'
    else:
        # si no tiene punto sigo normalmente
        if palabra in dicc[palabra_anterior]:
            dicc[palabra_anterior][palabra] += 1
        else:
            dicc[palabra_anterior][palabra] = 1

        palabra_anterior = palabra


texto = []
palabra = 'inicio'
while palabra != '.':
    palabras = []
    for key in dicc[palabra].keys():
        palabras = palabras + [key] * dicc[palabra][key]

    rp = palabras[random.randint(0, len(palabras)-1)]

    texto.append(rp)

    palabra = rp

print(" ".join(texto).capitalize())